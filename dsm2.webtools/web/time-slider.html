<!doctype html>
<html>
<head>
<title>Time Slider</title>
<link rel="import" href="./bower_components/polymer/polymer.html">
<link rel="import"
	href="./bower_components/paper-slider/paper-slider.html">
</head>
<body>
<dom-module id="time-slider">
  <template>
  
    <style>
      :host {
        display: block;
      }
    </style>
    <div class="container flex-horizontal">
		<div id="time">Time: {{currentImmediateTime}}</div>
		<paper-slider id="slider" snaps="true" maxMarkers="100000" name = "Time" step="86400" ></paper-slider>
	</div>
  </template>
  <script src="js/d3-time.v1.min.js"></script>
  <script src="js/d3-time-format.v2.min.js"></script>

  <script>
    Polymer({
      is: 'time-slider',
      properties: {
        currentTime: {
          type: String,
          value: '02JAN1990',
          notify: true
        },
        beginTime: {
        	type: String,
        	value: '01JAN1990'
        } ,
        endTime: {
        	type: String,
        	value: '01JAN2000'
        },
        currentImmediateTime: {
        	type: String,
        	notify: false
        }
      },
      
      observers: [
    	'_updateMinMax(beginTime, endTime)'  
      ],
      
      listeners: {
    	'slider.immediate-value-change' : '_onImmediateValueChange',
    	'slider.change' : '_onValueChange'
      },
      
      _onImmediateValueChange: function(){
    	this.currentImmediateTime = this.timeFormat(this.$.slider.immediateValue).toUpperCase();
      },
      
      _onValueChange: function(){
    	  this.currentTime = this.timeFormat(this.$.slider.value).toUpperCase();
      },
      
      _formatTime: function(timeValue){
    	  return this.timeFormat(timeValue);
      },
      
      _updateMinMax: function(beginTime, endTime){
    	  //console.log('_updateMinMax: ', beginTime, endTime)
    	  this.beginTimeInMins = this.timeParse(beginTime).getTime();
    	  this.endTimeInMins = this.timeParse(endTime).getTime();
    	  this.$.slider.max = this.endTimeInMins;
    	  this.$.slider.min = this.beginTimeInMins;
    	  this._onImmediateValueChange();
    	  this._onValueChange();
      },
      
      _setCurrentTime: function(value){
    	  console.log('_setCurrentTime: ',value)
      },
      
      created: function(){
			this.timeFormat = d3.timeFormat("%d%b%Y")
			this.timeParse = d3.timeParse("%d%b%Y")
      },
      
      onready: function(){
    	  
      }
    });
  </script>
</dom-module>
</body>
</html>